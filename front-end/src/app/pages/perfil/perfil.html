@if (usuario()) {
  <div class="container mt-4 mb-5">
    
    <div class="text-center">
      <h1>Perfil de {{ usuario()?.nombreUsuario }}</h1>
      
      @if (usuario()?.urlFoto) {
        <img 
          [src]="usuario()?.urlFoto" 
          alt="Foto de perfil" 
          class="foto-perfil-grande"> 
      } @else {
        <div class="foto-perfil-grande d-flex align-items-center justify-content-center bg-light text-muted">
          (Sin foto)
        </div>
      }
      
      <div class="mt-3">
        <p class="fs-5 mb-1"><strong>{{ usuario()?.nombre }} {{ usuario()?.apellido }}</strong></p>
        <p class="text-muted mb-1">{{ usuario()?.correo }}</p>
        <p class="fst-italic">{{ usuario()?.descripcion }}</p>
      </div>
    </div>

    <hr class="my-4">
    
    <h3 class="mb-4">Mis últimas publicaciones</h3>

    @if (misPublicaciones().length > 0) {
      <div class="publicaciones-container">
        @for (pub of misPublicaciones(); track pub._id) {
          
          <div class="publicacion-wrapper card p-2 shadow-sm" style="width: 350px;">
            <app-publicacion 
              [publicacion]="pub" 
              [currentUserId]="currentUserId()"
              (onLike)="onLike($event)"
              (onUnlike)="onUnlike($event)"
              (onDelete)="onDelete($event)">
            </app-publicacion>

            <div class="mt-3 border-top pt-2">
              <h6 class="small text-secondary">Comentarios recientes:</h6>
              <ul class="list-unstyled small">
                @for (com of pub.comentarios; track com._id) {
                  <li class="mb-1">
                    <strong>{{ com.autor.nombreUsuario }}:</strong> {{ com.mensaje }}
                  </li>
                } @empty {
                  <li class="text-muted font-italic">Sin comentarios aún.</li>
                }
              </ul>
            </div>
          </div>

        }
      </div>
    } @else {
      <div class="alert alert-info text-center">
        Aún no has realizado publicaciones.
      </div>
    }
  </div>

} @else {
  <div class="text-center mt-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2">Cargando perfil...</p>
  </div>
}